require("esri/map esri/layers/FeatureLayer esri/tasks/query dijit/layout/ContentPane dijit/layout/BorderContainer dojox/widget/AnalogGauge dojox/widget/gauge/AnalogArcIndicator".split(" "));var app={abbrLookup:{Wisconsin:"WI"}};
function init(){app.map=new esri.Map("map",{basemap:"oceans",center:[-88.03075,44.9],zoom:7});var a=dojo.string.substitute("STATE_NAME IN (${0})",["'Wisconsin'"]),e=["POP2007","STATE_NAME","NAME"],b=(new esri.symbol.SimpleLineSymbol).setColor(dojo.colorFromHex("#fff"));app.sym=(new esri.symbol.SimpleFillSymbol).setColor(new dojo.Color([52,67,83,.4])).setOutline(b);var b=new esri.renderer.SimpleRenderer(app.sym),c=dojo.colorFromHex("#ff3"),c=(new esri.symbol.SimpleLineSymbol).setColor(c).setWidth(4);
app.highlight=(new esri.symbol.SimpleFillSymbol).setColor(new dojo.Color([0,0,0,0])).setOutline(c);var c=new esri.tasks.QueryTask("https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer/2"),d=new esri.tasks.Query,f=new esri.tasks.StatisticDefinition;f.statisticType="max";f.onStatisticField="POP2007";f.outStatisticFieldName="maxPop";d.returnGeometry=!1;d.where=a;d.outFields=e;d.outStatistics=[f];c.execute(d,handlePopQuery);app.wiCounties=new esri.layers.FeatureLayer("https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer/2",
{id:"Wisconsin",mode:esri.layers.FeatureLayer.MODE_ONDEMAND,outFields:e});app.wiCounties.setDefinitionExpression(a);app.wiCounties.setRenderer(b);dojo.connect(app.wiCounties,"onMouseOver",showInfo);app.map.addLayer(app.wiCounties);createGauge(dojo.byId("gauge"),0)}function showInfo(a){app.map.graphics.clear();app.map.graphics.add(new esri.Graphic(a.graphic.geometry,app.highlight));updateGauge(a.graphic)}
function createGauge(a,e){var b=new dojox.widget.gauge.AnalogArcIndicator({interactionMode:"gauge",noChange:!1,value:e,width:20,offset:65,color:"#ff3",title:"value",hideValue:!0,duration:100});app.gauge=new dojox.widget.AnalogGauge({background:[200,200,200,0],width:parseInt(a.style.width,10),height:parseInt(a.style.height,10),cx:parseInt(a.style.width,10)/2,cy:.75*parseInt(a.style.height,10),style:"position: absolute;",radius:parseInt(a.style.width,10)/2,useTooltip:!1,ranges:[{low:0,high:100,color:"rgba(255,0,0,0)"}],
majorTicks:{offset:90,interval:25,length:3,color:"black"},indicators:[b]},dojo.create("div",null,a));app.gauge.startup();app.percentDiv=dojo.create("div",{innerHTML:"0%",style:{position:"absolute",bottom:app.gauge.height-app.gauge.cy+"px",left:"-1000px","font-family":"verdana","font-size":"24px",color:"#000"}});dojo.place(app.percentDiv,app.gauge.domNode);b=dojo.contentBox(app.percentDiv);dojo.style(app.percentDiv,"left",app.gauge.cx+"px");dojo.style(app.percentDiv,"marginLeft",-b.w/2+"px");app.gauge.cx&&
dojo.style(app.percentDiv,"marginBottom",-b.h/2+"px")}function updateGauge(a){dojo.byId("county").innerHTML="Highlighted: "+a.attributes.NAME+" County, "+app.abbrLookup[a.attributes.STATE_NAME]+"<br />Population (2007): "+dojo.number.format(a.attributes.POP2007);a=parseInt(a.attributes.POP2007/app.maxPop*100,10);app.percentDiv.innerHTML=a+"%";app.gauge.indicators[0].update(a)}function handlePopQuery(a){console.log("pop query...",a);app.maxPop=a.features[0].attributes.maxPop}dojo.ready(init);